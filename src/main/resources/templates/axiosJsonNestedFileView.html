<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ê°€ì…</title>
</head>
<body>
<div style="margin-left: 10%; margin-right: 10%;">
<h3>ğŸ™‚ ì„±ì  ì…ë ¥ </h3>
<form id="form-view">
    ì´ë¦„ : <input type="text"id="name"  name="name"> <br>
    email : <input type="text" id="email" name="email"> <br>
    <div id="grades">
        <p>ì„±ì  ì •ë³´ : </p>
        <div class="grade">
            ìˆ˜ì—…ëª… : <input type="text" class = "className" name="className"> <br>
            ì ìˆ˜ : <input type="text" class="point" name="point"> <br>
        </div>
    </div>
    <button type="button" onclick="addGrade()">ì„±ì  ì¶”ê°€</button>
    <br>
    <input type="submit" value="ì œì¶œ">
</form>
</div>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    function addGrade(){
        const gradeDiv = document.getElementById('grades');
        gradeDiv.innerHTML +=`
            <div class="grade">
                ìˆ˜ì—…ëª… : <input type="text" class = "className" name="className"> <br>
                ì ìˆ˜ : <input type="text" class="point" name="point"> <br>
            </div>`
    }
    document.getElementById("form-view").addEventListener('submit',
    async function(event){
        event.preventDefault();
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
        let grades = [];
        const gradeDivs = document.getElementsByClassName('grade');
        for(let i = 0 ; i < gradeDivs.length ; i++){
            const className = gradeDivs[i].getElementsByClassName('className')[0].value;
            const point = gradeDivs[i].getElementsByClassName('point')[0].value;
            const gradeObj = {className,point};
            grades.push(gradeObj);
        }
        try{
            const response = await axios.post('http://localhost:8080/hello/axios-nested-json-view',
                {name:name, email:email, grades:grades});
            console.log(response.data);
        }catch(e){
            console.log(e);
        }
    }
)

</script>
</body>
</html>